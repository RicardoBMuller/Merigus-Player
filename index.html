<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Ricardo Capel | Merigus Player</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-color: #121212;
            --card-color: #181818;
            --item-hover: #282828;
            --text-primary: #ffffff;
            --text-secondary: #b3b3b3;
            --accent-color: #1db954;
            --accent-hover: #1ed760;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-primary);
            font-family: 'Circular Std', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            margin: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
        }

        /* Fundo animado */
        body::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 50% 50%, rgba(29,185,84,0.1) 0%, rgba(18,18,18,0) 70%);
            z-index: -1;
            position: fixed; /* Fica fixo ao rolar */
        }

        /* Container Principal que segura a Lista e o Player */
        .main-wrapper {
            display: flex;
            gap: 20px;
            padding: 20px;
            width: 95%;
            max-width: 900px;
            height: 85vh; /* Altura fixa para permitir rolagem interna */
            align-items: center;
        }

        /* --- 1. ESTILO DA LISTA (ESQUERDA) --- */
        .playlist-sidebar {
            background-color: var(--card-color);
            flex: 1; /* Ocupa o espaço restante */
            height: 100%;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            overflow: hidden; /* Para a barra de rolagem ficar interna */
            min-width: 250px;
        }

        .playlist-header {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 20px;
            border-bottom: 1px solid #333;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .playlist-items {
            list-style: none;
            padding: 0;
            margin: 0;
            overflow-y: auto; /* Rolagem vertical */
            flex-grow: 1;
        }

        /* Scrollbar personalizada */
        .playlist-items::-webkit-scrollbar {
            width: 6px;
        }
        .playlist-items::-webkit-scrollbar-thumb {
            background-color: #444;
            border-radius: 4px;
        }

        .playlist-item {
            display: flex;
            align-items: center;
            padding: 12px 10px;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.2s;
            border-bottom: 1px solid #222;
        }

        .playlist-item:hover {
            background-color: var(--item-hover);
        }

        /* Música Ativa na lista */
        .playlist-item.active-song {
            background-color: #222;
        }
        .playlist-item.active-song .item-title {
            color: var(--accent-color);
        }
        .playlist-item.active-song .item-icon {
            opacity: 1; /* Mostra o ícone de 'tocando' */
        }

        .item-icon {
            font-size: 0.8rem;
            color: var(--accent-color);
            margin-right: 12px;
            opacity: 0; /* Invisível por padrão */
            width: 15px;
        }

        .item-info {
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .item-title {
            font-size: 0.95rem;
            font-weight: 500;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: var(--text-primary);
        }

        .item-artist {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }


        /* --- 2. ESTILO DO PLAYER (DIREITA) --- */
        .player-container {
            background-color: var(--card-color);
            width: 350px; /* Largura fixa para o player */
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.6);
            display: flex;
            flex-direction: column;
            flex-shrink: 0; /* Não deixa o player encolher */
        }

        /* (CSS do Player mantido igual ao anterior...) */
        .cover-area {
            width: 100%;
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(0,0,0,0.5);
            margin-bottom: 25px;
            position: relative;
            background-color: #333;
        }

        .cover-area img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .song-info-player {
            text-align: left;
            margin-bottom: 20px;
        }

        .song-title-main {
            font-size: 1.4rem;
            font-weight: 700;
            margin: 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .artist-name-main {
            color: var(--text-secondary);
            font-size: 1rem;
            margin-top: 5px;
        }

        .progress-area {
            height: 6px;
            width: 100%;
            background: #4f4f4f;
            border-radius: 50px;
            cursor: pointer;
            margin-bottom: 10px;
            padding: 5px 0;
        }

        .progress-bar {
            height: 6px;
            width: 0%;
            background: var(--text-primary);
            border-radius: 50px;
            position: relative;
            transition: width 0.1s linear;
        }
        .playing .progress-bar { background: var(--accent-color); }
        .progress-bar::after {
            content: ''; position: absolute; right: -6px; top: 50%; transform: translateY(-50%);
            width: 14px; height: 14px; background: #fff; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .timers {
            display: flex; justify-content: space-between; font-size: 0.8rem; color: var(--text-secondary); margin-bottom: 20px;
        }

        .controls {
            display: flex; justify-content: space-between; align-items: center; padding: 0 5px;
        }

        .btn {
            background: none; border: none; color: var(--text-secondary); font-size: 1.2rem; cursor: pointer; padding: 10px; transition: color 0.2s; position: relative;
        }
        .btn:hover { color: var(--text-primary); }
        .btn.active { color: var(--accent-color); }
        .btn.active::after { content: ''; position: absolute; bottom: 5px; left: 50%; transform: translateX(-50%); width: 4px; height: 4px; background-color: var(--accent-color); border-radius: 50%; }

        .btn-main {
            width: 60px; height: 60px; background-color: var(--text-primary); color: #000; border-radius: 50%; font-size: 1.5rem; display: flex; justify-content: center; align-items: center; box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .btn-main:hover { transform: scale(1.05); background-color: var(--accent-hover); }

        /* --- RESPONSIVIDADE (MOBILE) --- */
        @media (max-width: 800px) {
            .main-wrapper {
                flex-direction: column-reverse; /* Player em cima, Lista em baixo */
                height: auto; /* Altura automática para rolar a página */
                margin-top: 20px;
                display: block; /* Remove flex para comportamento de bloco natural no mobile */
                padding: 10px;
            }

            .player-container {
                width: 100%; /* Player ocupa largura total */
                max-width: 400px;
                margin: 0 auto 30px auto; /* Centraliza */
                position: sticky; /* Opcional: faz o player grudar no topo */
                top: 10px;
                z-index: 100;
            }

            .playlist-sidebar {
                width: 100%;
                max-width: 400px;
                margin: 0 auto;
                height: 400px; /* Altura fixa da lista no mobile */
            }
        }
    </style>
</head>
<body>

<div class="main-wrapper">
    
    <div class="playlist-sidebar">
        <div class="playlist-header">
            <i class="fas fa-list"></i> Minhas Músicas
        </div>
        <ul class="playlist-items" id="playlist-ul">
            </ul>
    </div>

    <div class="player-container" id="player">
        <div class="cover-area">
            <img src="" alt="Capa" id="cover">
        </div>

        <div class="song-info-player">
            <h2 class="song-title-main" id="title">Carregando...</h2>
            <p class="artist-name-main" id="artist">Ricardo Capel</p>
        </div>

        <div class="progress-area" id="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        <div class="timers">
            <span id="current-time">0:00</span>
            <span id="duration">0:00</span>
        </div>

        <div class="controls">
            <button class="btn" id="shuffle"><i class="fas fa-shuffle"></i></button>
            <button class="btn" id="prev"><i class="fas fa-step-backward"></i></button>
            <button class="btn btn-main" id="play"><i class="fas fa-play"></i></button>
            <button class="btn" id="next"><i class="fas fa-step-forward"></i></button>
            <button class="btn" id="repeat"><i class="fas fa-repeat"></i></button>
        </div>
    </div>

</div>

<audio id="audio"></audio>

<script>
    // --- LISTA DE MÚSICAS ---
    const songs = [
        {
            "title": "I Walk The Shadows... Of A Sunless Day (V1)",
            "artist": "Ricardo Capel",
            "src": "musicas/I walk the shadows... of a sunless day (V1).mp3",
            "cover": "musicas/capa_shadows.jpg" 
        },
        {
            "title": "I Walk The Shadows... Of A Sunless Day (V2)",
            "artist": "Ricardo Capel",
            "src": "musicas/I walk the shadows... of a sunless day (V2).mp3",
            "cover": "musicas/capa_shadows.jpg"
        },
        {
            "title": "The Pain Is Real (V1)",
            "artist": "Ricardo Capel",
            "src": "musicas/The pain is real (V1).mp3",
            "cover": "musicas/capa_pain.jpg"
        },
        {
            "title": "The Pain Is Real (V2)",
            "artist": "Ricardo Capel",
            "src": "musicas/The pain is real (V2).mp3",
            "cover": "musicas/capa_pain.jpg"
        }
    ];

    // --- ELEMENTOS ---
    const audio = document.getElementById('audio');
    const playBtn = document.getElementById('play');
    const prevBtn = document.getElementById('prev');
    const nextBtn = document.getElementById('next');
    const shuffleBtn = document.getElementById('shuffle');
    const repeatBtn = document.getElementById('repeat');
    
    const titleEl = document.getElementById('title');
    const artistEl = document.getElementById('artist');
    const coverEl = document.getElementById('cover');
    const progressContainer = document.getElementById('progress-container');
    const progressBar = document.getElementById('progress-bar');
    const currTimeEl = document.getElementById('current-time');
    const durTimeEl = document.getElementById('duration');
    const playerContainer = document.getElementById('player');
    const playlistUl = document.getElementById('playlist-ul'); // A lista

    const defaultCover = "https://images.unsplash.com/photo-1511379938547-c1f69419868d?q=80&w=1000&auto=format&fit=crop";

    let songIndex = 0;
    let isShuffle = false;
    let isRepeat = false;

    // --- 1. FUNÇÃO PARA GERAR A PLAYLIST VISUAL ---
    function renderPlaylist() {
        playlistUl.innerHTML = ""; // Limpa a lista antes de gerar
        
        songs.forEach((song, index) => {
            // Cria o elemento LI
            const li = document.createElement('li');
            li.classList.add('playlist-item');
            
            // Adiciona evento de clique: Toca a música clicada
            li.addEventListener('click', () => {
                songIndex = index;
                loadSong(songs[songIndex]);
                playSong();
            });

            // HTML interno do item
            li.innerHTML = `
                <div class="item-icon"><i class="fas fa-volume-high"></i></div>
                <div class="item-info">
                    <span class="item-title">${song.title}</span>
                    <span class="item-artist">${song.artist}</span>
                </div>
            `;
            
            playlistUl.appendChild(li);
        });
    }

    // --- 2. ATUALIZAR DESTAQUE NA LISTA ---
    function updatePlaylistActiveState() {
        const items = document.querySelectorAll('.playlist-item');
        
        items.forEach((item, index) => {
            if (index === songIndex) {
                item.classList.add('active-song');
                // Auto scroll para a música ativa se a lista for longa
                item.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            } else {
                item.classList.remove('active-song');
            }
        });
    }

    // --- FUNÇÕES DO PLAYER ---
    
    // Inicializar
    renderPlaylist(); // Gera a lista
    loadSong(songs[songIndex]); // Carrega a 1ª música

    function loadSong(song) {
        titleEl.innerText = song.title;
        artistEl.innerText = song.artist;
        audio.src = encodeURI(song.src);
        
        if(song.cover && song.cover.trim() !== "") {
            coverEl.src = song.cover;
        } else {
            coverEl.src = defaultCover;
        }
        coverEl.onerror = function() { this.src = defaultCover; };

        // Atualiza quem está verde na lista
        updatePlaylistActiveState();
    }

    function playSong() {
        playerContainer.classList.add('playing');
        playBtn.querySelector('i').classList.remove('fa-play');
        playBtn.querySelector('i').classList.add('fa-pause');
        audio.play();
    }

    function pauseSong() {
        playerContainer.classList.remove('playing');
        playBtn.querySelector('i').classList.add('fa-play');
        playBtn.querySelector('i').classList.remove('fa-pause');
        audio.pause();
    }

    playBtn.addEventListener('click', () => {
        const isPlaying = playerContainer.classList.contains('playing');
        isPlaying ? pauseSong() : playSong();
    });

    function prevSong() {
        if(audio.currentTime > 3) { audio.currentTime = 0; return; }
        
        if (isShuffle) {
            playRandomSong();
        } else {
            songIndex--;
            if (songIndex < 0) songIndex = songs.length - 1;
            loadSong(songs[songIndex]);
            playSong();
        }
    }

    function nextSong() {
        if (isShuffle) {
            playRandomSong();
        } else {
            songIndex++;
            if (songIndex > songs.length - 1) songIndex = 0;
            loadSong(songs[songIndex]);
            playSong();
        }
    }

    function playRandomSong() {
        let newIndex;
        do { newIndex = Math.floor(Math.random() * songs.length); } 
        while (newIndex === songIndex && songs.length > 1);
        songIndex = newIndex;
        loadSong(songs[songIndex]);
        playSong();
    }

    prevBtn.addEventListener('click', prevSong);
    nextBtn.addEventListener('click', nextSong);

    shuffleBtn.addEventListener('click', () => {
        isShuffle = !isShuffle;
        shuffleBtn.classList.toggle('active', isShuffle);
    });

    repeatBtn.addEventListener('click', () => {
        isRepeat = !isRepeat;
        repeatBtn.classList.toggle('active', isRepeat);
    });

    function updateProgress(e) {
        const { duration, currentTime } = e.srcElement;
        const progressPercent = (currentTime / duration) * 100;
        progressBar.style.width = `${progressPercent}%`;
        
        if(duration) {
            const durationMin = Math.floor(duration / 60);
            const durationSec = Math.floor(duration % 60);
            durTimeEl.innerText = `${durationMin}:${durationSec < 10 ? '0' : ''}${durationSec}`;
        }
        const currentMin = Math.floor(currentTime / 60);
        const currentSec = Math.floor(currentTime % 60);
        currTimeEl.innerText = `${currentMin}:${currentSec < 10 ? '0' : ''}${currentSec}`;
    }

    function setProgress(e) {
        const width = this.clientWidth;
        const clickX = e.offsetX;
        const duration = audio.duration;
        audio.currentTime = (clickX / width) * duration;
    }

    audio.addEventListener('timeupdate', updateProgress);
    progressContainer.addEventListener('click', setProgress);
    
    audio.addEventListener('ended', () => {
        if (isRepeat) {
            audio.currentTime = 0;
            playSong();
        } else {
            nextSong();
        }
    });

    if ('mediaSession' in navigator) {
        navigator.mediaSession.setActionHandler('play', playSong);
        navigator.mediaSession.setActionHandler('pause', pauseSong);
        navigator.mediaSession.setActionHandler('previoustrack', prevSong);
        navigator.mediaSession.setActionHandler('nexttrack', nextSong);
    }
</script>
</body>
</html>
